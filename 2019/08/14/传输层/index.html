<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="libinxu">
  <!-- Open Graph Data -->
  <meta property="og:title" content="MonkeyDLee">
  <meta property="og:description" content="C/C++">
  <meta property="og:site_name" content="MonkeyDLee">
  <meta property="og:type" content="website">
  <meta property="og:image" content="http://yoursite.com">
  
    <link rel="alternate" href="/atom.xml" title="MonkeyDLee" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>MonkeyDLee</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/default-banner-dark.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">Untitled Post</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/MonkeyDLee">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:532900395@qq.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By libinxu</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2019-08-14</span>
            <span class="time">23:58:14</span>
          </span>
          
        </div>
        <!-- Tags -->
        
        <!-- Post Main Content -->
        <div class="post-content">
          <h1 id="传输层"><a href="#传输层" class="headerlink" title="传输层:"></a>传输层:</h1><p><strong>负责数据能够从发送端传输接收端.</strong> </p>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="端口"><a href="#端口" class="headerlink" title="端口:"></a>端口:</h3><p><strong>端口号范围</strong>:  0~65535    0~1023不推荐使用,在一台主机上唯一标识一个进程</p>
<p><strong>0~1023被知名协议使用:</strong></p>
<ol>
<li>ssh服务器, 使用22端口</li>
<li>ftp服务器, 使用21端口 </li>
<li>telnet服务器, 使用23端口 </li>
<li>http服务器, 使用80端口 </li>
<li>https服务器, 使用443</li>
</ol>
<p><strong>功能</strong>: 操作系统使用网卡接收数据,通过端口号就可以知道将数据放到那个socket缓冲区</p>
<p>​               一个端口号只能有一个进程使用,一个进程可以使用多个端口号</p>
<p><strong>五元组</strong>:一条网络数据包含的五条信息:源IP+源端口+目的IP+目的端口+协议</p>
<h3 id="主机上网络状态的查看"><a href="#主机上网络状态的查看" class="headerlink" title="主机上网络状态的查看"></a>主机上网络状态的查看</h3><p><strong>netstat</strong>:查看网络状态 </p>
<p><strong>常用选项</strong></p>
<ul>
<li>n 拒绝显示别名，能显示数字的全部转化成数字</li>
<li>l 仅列出有在 Listen (监听) 的服務状态 </li>
<li>p 显示建立相关链接的程序名 </li>
<li>t (tcp)仅显示tcp相关选项 </li>
<li>u (udp)仅显示udp相关选项 </li>
<li>a (all)显示所有选项，默认不显示LISTEN相关 </li>
</ul>
<h2 id="UDP协议"><a href="#UDP协议" class="headerlink" title="UDP协议"></a>UDP协议</h2><h4 id="特点-无连接-不可靠-面向数据报"><a href="#特点-无连接-不可靠-面向数据报" class="headerlink" title="特点:无连接,不可靠,面向数据报"></a><strong>特点:</strong>无连接,不可靠,面向数据报</h4><ul>
<li>无连接: 知道对端的IP和端口号就直接进行传输, 不需要建立连接; </li>
<li>不可靠: 没有确认机制, 没有重传机制; 如果因为网络故障该段无法发到对方, UDP协议层也不会给应用层 返回任何错误信息; </li>
<li>面向数据报: 不能够灵活的控制读写数据的次数和数量数据整条收发,灵活性低,不会产生黏包</li>
</ul>
<h4 id="udp协议包含字段"><a href="#udp协议包含字段" class="headerlink" title="udp协议包含字段"></a>udp协议包含字段</h4><p><img src="D:\MyBlog\source\images\UDP格式.png" alt=""></p>
<h4 id="UDP的缓冲区"><a href="#UDP的缓冲区" class="headerlink" title="UDP的缓冲区**"></a>UDP的缓冲区**</h4><p>UDP没有真正意义上的 发送缓冲区. 调用sendto会直接交给内核, 由内核将数据传给网络层协议进行后 续的传输动作; UDP具有接收缓冲区. 但是这个接收缓冲区不能保证收到的UDP报的顺序和发送UDP报的顺序一致; 如果 缓冲区满了, 再到达的UDP数据就会被丢弃; UDP的socket既能读, 也能写, 这个概念叫做 全双工</p>
<h2 id="TCP协议"><a href="#TCP协议" class="headerlink" title="TCP协议"></a>TCP协议</h2><h4 id="特点"><a href="#特点" class="headerlink" title="特点:"></a>特点:</h4><h4 id="连接管理"><a href="#连接管理" class="headerlink" title="连接管理:"></a>连接管理:</h4><p><img src="D:\MyBlog\source\images\tcp连接管理.png" alt=""></p>
<h4 id="TIME-WAIT的必要性"><a href="#TIME-WAIT的必要性" class="headerlink" title="TIME_WAIT的必要性:"></a>TIME_WAIT的必要性:</h4><ol>
<li>如果没有TIME_WAIT,最后一个ack丢失，被动关闭方重发FIN， 主动关闭方没有等待直接关闭，假如启动服务又使用相同的端口，有可能收到上一个连接重发的FIN，对新连接造成影响。</li>
<li>若新的客户端使用相同的端口信息，向服务端发送SYN请求但是服务端没有收到SYN最后一个ACK处于LAST_ACK状态，收到SYN判定状态错误，回复RST报文重置连接，对新连接造成影响所以主动关闭方发送最后一个ack之后需要等待：两个MSL</li>
</ol>
<ul>
<li>等待ack丢失导致对端重传的FIN包</li>
<li>等待网络中所有双方延迟的报文消失</li>
</ul>
<h4 id="可靠传输："><a href="#可靠传输：" class="headerlink" title="可靠传输："></a>可靠传输：</h4><p><img src="D:\MyBlog\source\images\TCP.jpg" alt=""></p>
<p>确认应答 超时重传 有序：协议字段中的确认序号和序号</p>
<p>因为可靠传输，牺牲了部分新能；因此引入了几种机制提高性能</p>
<h5 id="滑动窗口：连续发送多条数据等待回复"><a href="#滑动窗口：连续发送多条数据等待回复" class="headerlink" title="滑动窗口：连续发送多条数据等待回复"></a>滑动窗口：连续发送多条数据等待回复</h5><h6 id="流量控制"><a href="#流量控制" class="headerlink" title="流量控制"></a>流量控制</h6><h6 id="快速重传"><a href="#快速重传" class="headerlink" title="快速重传"></a>快速重传</h6><p>接收端每条数据都要回复，要按序回复，即使后一条到了但是前一条没有到达也不回复后到的数据，只有上一条回复之后才回复，所以如果发送端收到了第二条的回复，即使第一条的回复丢失了也不会重传</p>
<p>当数据连续发送信息，当数据丢失时，接收端连续发送三次（防止网络时延）重传请求，当发送端接收到了第三次重传请求，则会对这条数据重传</p>
<h6 id="滑动窗口"><a href="#滑动窗口" class="headerlink" title="滑动窗口"></a>滑动窗口</h6><h6 id="拥塞窗口机制：慢启动，快增长。"><a href="#拥塞窗口机制：慢启动，快增长。" class="headerlink" title="拥塞窗口机制：慢启动，快增长。"></a>拥塞窗口机制：慢启动，快增长。</h6><h5 id="延迟应答机制：尽可能保持窗口大小，保持网络吞吐率"><a href="#延迟应答机制：尽可能保持窗口大小，保持网络吞吐率" class="headerlink" title="延迟应答机制：尽可能保持窗口大小，保持网络吞吐率"></a>延迟应答机制：尽可能保持窗口大小，保持网络吞吐率</h5><h5 id="捎带应答机制：尽量减少不必要的确认应答包"><a href="#捎带应答机制：尽量减少不必要的确认应答包" class="headerlink" title="捎带应答机制：尽量减少不必要的确认应答包"></a>捎带应答机制：尽量减少不必要的确认应答包</h5><h4 id="面向字节流"><a href="#面向字节流" class="headerlink" title="面向字节流"></a>面向字节流</h4><p>tcp的粘包：tcp没有边界</p>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        </p><p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  <script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>

